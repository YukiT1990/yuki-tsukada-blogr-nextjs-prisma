{"ast":null,"code":"var _jsxFileName = \"/Users/yuki.t/Desktop/NextJSPractice/blogr-nextjs-prisma/pages/drafts.tsx\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React from \"react\";\nimport Layout from \"../components/Layout\";\nimport Post from \"../components/Post\";\nimport { useSession, getSession } from \"next-auth/client\";\nimport prisma from \"../lib/prisma\";\nexport const getServerSideProps = async ({\n  req,\n  res\n}) => {\n  const session = await getSession({\n    req\n  });\n\n  if (!session) {\n    res.statusCode = 403;\n    return {\n      props: {\n        drafts: []\n      }\n    };\n  }\n\n  const draftsR = await prisma.post.findMany({\n    where: {\n      author: {\n        email: session.user.email\n      },\n      published: false\n    },\n    include: {\n      author: {\n        select: {\n          name: true\n        }\n      }\n    }\n  });\n  let draftsU = JSON.parse(JSON.stringify(draftsR));\n  let drafts = draftsU.sort((p1, p2) => {\n    return p2.createdAt > p1.createdAt ? 1 : -1;\n  });\n  return {\n    props: {\n      drafts\n    }\n  };\n};\n\nconst Drafts = props => {\n  const [session] = useSession();\n\n  if (!session) {\n    return __jsx(Layout, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 7\n      }\n    }, __jsx(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 9\n      }\n    }, \"My Drafts\"), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }\n    }, \"You need to be authenticated to view this page.\"));\n  }\n\n  return __jsx(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"jsx-3495282894\" + \" \" + \"page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }, __jsx(\"h1\", {\n    className: \"jsx-3495282894\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, \"My Drafts\"), __jsx(\"main\", {\n    className: \"jsx-3495282894\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }\n  }, props.drafts.map(post => __jsx(\"div\", {\n    key: post.id,\n    className: \"jsx-3495282894\" + \" \" + \"post\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }, __jsx(Post, {\n    post: post,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 15\n    }\n  }))))), __jsx(_JSXStyle, {\n    id: \"3495282894\",\n    __self: this\n  }, \".post.jsx-3495282894{background:white;-webkit-transition:box-shadow 0.1s ease-in;transition:box-shadow 0.1s ease-in;}.post.jsx-3495282894:hover{box-shadow:1px 1px 3px #aaa;}.post.jsx-3495282894+.post.jsx-3495282894{margin-top:2rem;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dWtpLnQvRGVza3RvcC9OZXh0SlNQcmFjdGljZS9ibG9nci1uZXh0anMtcHJpc21hL3BhZ2VzL2RyYWZ0cy50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBK0RrQixBQUc0QixBQUtXLEFBSVosZ0JBQ2xCLENBVHFDLFdBS3JDLG1FQUpBIiwiZmlsZSI6Ii9Vc2Vycy95dWtpLnQvRGVza3RvcC9OZXh0SlNQcmFjdGljZS9ibG9nci1uZXh0anMtcHJpc21hL3BhZ2VzL2RyYWZ0cy50c3giLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBHZXRTZXJ2ZXJTaWRlUHJvcHMgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IExheW91dCBmcm9tIFwiLi4vY29tcG9uZW50cy9MYXlvdXRcIjtcbmltcG9ydCBQb3N0LCB7IFBvc3RQcm9wcyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1Bvc3RcIjtcbmltcG9ydCB7IHVzZVNlc3Npb24sIGdldFNlc3Npb24gfSBmcm9tIFwibmV4dC1hdXRoL2NsaWVudFwiO1xuaW1wb3J0IHByaXNtYSBmcm9tIFwiLi4vbGliL3ByaXNtYVwiO1xuXG5leHBvcnQgY29uc3QgZ2V0U2VydmVyU2lkZVByb3BzOiBHZXRTZXJ2ZXJTaWRlUHJvcHMgPSBhc3luYyAoeyByZXEsIHJlcyB9KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKHsgcmVxIH0pO1xuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJlcy5zdGF0dXNDb2RlID0gNDAzO1xuICAgIHJldHVybiB7IHByb3BzOiB7IGRyYWZ0czogW10gfSB9O1xuICB9XG5cbiAgY29uc3QgZHJhZnRzUiA9IGF3YWl0IHByaXNtYS5wb3N0LmZpbmRNYW55KHtcbiAgICB3aGVyZToge1xuICAgICAgYXV0aG9yOiB7IGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwgfSxcbiAgICAgIHB1Ymxpc2hlZDogZmFsc2UsXG4gICAgfSxcbiAgICBpbmNsdWRlOiB7XG4gICAgICBhdXRob3I6IHtcbiAgICAgICAgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG4gIGxldCBkcmFmdHNVID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkcmFmdHNSKSk7XG4gIGxldCBkcmFmdHMgPSBkcmFmdHNVLnNvcnQoKHAxOiBQb3N0UHJvcHMsIHAyOiBQb3N0UHJvcHMpID0+IHtcbiAgICByZXR1cm4gcDIuY3JlYXRlZEF0ID4gcDEuY3JlYXRlZEF0ID8gMSA6IC0xO1xuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBwcm9wczogeyBkcmFmdHMgfSxcbiAgfTtcbn07XG5cbnR5cGUgUHJvcHMgPSB7XG4gIGRyYWZ0czogUG9zdFByb3BzW107XG59O1xuXG5jb25zdCBEcmFmdHM6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCBbc2Vzc2lvbl0gPSB1c2VTZXNzaW9uKCk7XG5cbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxMYXlvdXQ+XG4gICAgICAgIDxoMT5NeSBEcmFmdHM8L2gxPlxuICAgICAgICA8ZGl2PllvdSBuZWVkIHRvIGJlIGF1dGhlbnRpY2F0ZWQgdG8gdmlldyB0aGlzIHBhZ2UuPC9kaXY+XG4gICAgICA8L0xheW91dD5cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8TGF5b3V0PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlXCI+XG4gICAgICAgIDxoMT5NeSBEcmFmdHM8L2gxPlxuICAgICAgICA8bWFpbj5cbiAgICAgICAgICB7cHJvcHMuZHJhZnRzLm1hcCgocG9zdCkgPT4gKFxuICAgICAgICAgICAgPGRpdiBrZXk9e3Bvc3QuaWR9IGNsYXNzTmFtZT1cInBvc3RcIj5cbiAgICAgICAgICAgICAgPFBvc3QgcG9zdD17cG9zdH0gLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICkpfVxuICAgICAgICA8L21haW4+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgLnBvc3Qge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xuICAgICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4xcyBlYXNlLWluO1xuICAgICAgICB9XG5cbiAgICAgICAgLnBvc3Q6aG92ZXIge1xuICAgICAgICAgIGJveC1zaGFkb3c6IDFweCAxcHggM3B4ICNhYWE7XG4gICAgICAgIH1cblxuICAgICAgICAucG9zdCArIC5wb3N0IHtcbiAgICAgICAgICBtYXJnaW4tdG9wOiAycmVtO1xuICAgICAgICB9XG4gICAgICBgfTwvc3R5bGU+XG4gICAgPC9MYXlvdXQ+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBEcmFmdHM7XG4iXX0= */\\n/*@ sourceURL=/Users/yuki.t/Desktop/NextJSPractice/blogr-nextjs-prisma/pages/drafts.tsx */\"));\n};\n\nexport default Drafts;","map":{"version":3,"sources":["/Users/yuki.t/Desktop/NextJSPractice/blogr-nextjs-prisma/pages/drafts.tsx"],"names":["React","Layout","Post","useSession","getSession","prisma","getServerSideProps","req","res","session","statusCode","props","drafts","draftsR","post","findMany","where","author","email","user","published","include","select","name","draftsU","JSON","parse","stringify","sort","p1","p2","createdAt","Drafts","map","id"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,IAAP,MAAgC,oBAAhC;AACA,SAASC,UAAT,EAAqBC,UAArB,QAAuC,kBAAvC;AACA,OAAOC,MAAP,MAAmB,eAAnB;AAEA,OAAO,MAAMC,kBAAsC,GAAG,OAAO;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAP,KAAwB;AAC5E,QAAMC,OAAO,GAAG,MAAML,UAAU,CAAC;AAAEG,IAAAA;AAAF,GAAD,CAAhC;;AAEA,MAAI,CAACE,OAAL,EAAc;AACZD,IAAAA,GAAG,CAACE,UAAJ,GAAiB,GAAjB;AACA,WAAO;AAAEC,MAAAA,KAAK,EAAE;AAAEC,QAAAA,MAAM,EAAE;AAAV;AAAT,KAAP;AACD;;AAED,QAAMC,OAAO,GAAG,MAAMR,MAAM,CAACS,IAAP,CAAYC,QAAZ,CAAqB;AACzCC,IAAAA,KAAK,EAAE;AACLC,MAAAA,MAAM,EAAE;AAAEC,QAAAA,KAAK,EAAET,OAAO,CAACU,IAAR,CAAaD;AAAtB,OADH;AAELE,MAAAA,SAAS,EAAE;AAFN,KADkC;AAKzCC,IAAAA,OAAO,EAAE;AACPJ,MAAAA,MAAM,EAAE;AACNK,QAAAA,MAAM,EAAE;AAAEC,UAAAA,IAAI,EAAE;AAAR;AADF;AADD;AALgC,GAArB,CAAtB;AAWA,MAAIC,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAed,OAAf,CAAX,CAAd;AACA,MAAID,MAAM,GAAGY,OAAO,CAACI,IAAR,CAAa,CAACC,EAAD,EAAgBC,EAAhB,KAAkC;AAC1D,WAAOA,EAAE,CAACC,SAAH,GAAeF,EAAE,CAACE,SAAlB,GAA8B,CAA9B,GAAkC,CAAC,CAA1C;AACD,GAFY,CAAb;AAGA,SAAO;AACLpB,IAAAA,KAAK,EAAE;AAAEC,MAAAA;AAAF;AADF,GAAP;AAGD,CA1BM;;AAgCP,MAAMoB,MAAuB,GAAIrB,KAAD,IAAW;AACzC,QAAM,CAACF,OAAD,IAAYN,UAAU,EAA5B;;AAEA,MAAI,CAACM,OAAL,EAAc;AACZ,WACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yDAFF,CADF;AAMD;;AAED,SACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA,wCAAe,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGE,KAAK,CAACC,MAAN,CAAaqB,GAAb,CAAkBnB,IAAD,IAChB;AAAK,IAAA,GAAG,EAAEA,IAAI,CAACoB,EAAf;AAAA,wCAA6B,MAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAM,IAAA,IAAI,EAAEpB,IAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADD,CADH,CAFF,CADF;AAAA;AAAA;AAAA,8uGADF;AA4BD,CAxCD;;AA0CA,eAAekB,MAAf","sourcesContent":["import React from \"react\";\nimport { GetServerSideProps } from \"next\";\nimport Layout from \"../components/Layout\";\nimport Post, { PostProps } from \"../components/Post\";\nimport { useSession, getSession } from \"next-auth/client\";\nimport prisma from \"../lib/prisma\";\n\nexport const getServerSideProps: GetServerSideProps = async ({ req, res }) => {\n  const session = await getSession({ req });\n\n  if (!session) {\n    res.statusCode = 403;\n    return { props: { drafts: [] } };\n  }\n\n  const draftsR = await prisma.post.findMany({\n    where: {\n      author: { email: session.user.email },\n      published: false,\n    },\n    include: {\n      author: {\n        select: { name: true },\n      },\n    },\n  });\n  let draftsU = JSON.parse(JSON.stringify(draftsR));\n  let drafts = draftsU.sort((p1: PostProps, p2: PostProps) => {\n    return p2.createdAt > p1.createdAt ? 1 : -1;\n  });\n  return {\n    props: { drafts },\n  };\n};\n\ntype Props = {\n  drafts: PostProps[];\n};\n\nconst Drafts: React.FC<Props> = (props) => {\n  const [session] = useSession();\n\n  if (!session) {\n    return (\n      <Layout>\n        <h1>My Drafts</h1>\n        <div>You need to be authenticated to view this page.</div>\n      </Layout>\n    );\n  }\n\n  return (\n    <Layout>\n      <div className=\"page\">\n        <h1>My Drafts</h1>\n        <main>\n          {props.drafts.map((post) => (\n            <div key={post.id} className=\"post\">\n              <Post post={post} />\n            </div>\n          ))}\n        </main>\n      </div>\n      <style jsx>{`\n        .post {\n          background: white;\n          transition: box-shadow 0.1s ease-in;\n        }\n\n        .post:hover {\n          box-shadow: 1px 1px 3px #aaa;\n        }\n\n        .post + .post {\n          margin-top: 2rem;\n        }\n      `}</style>\n    </Layout>\n  );\n};\n\nexport default Drafts;\n"]},"metadata":{},"sourceType":"module"}